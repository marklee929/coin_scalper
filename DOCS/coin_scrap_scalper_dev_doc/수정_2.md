ì‘ ê·¸ê²Œ ë§ì•„. **ì „ì²´ ì‹¬ë³¼ ëª©ë¡ì€ ë§¤ë²ˆ APIë¡œ ì•ˆ ê¸ê³ **
ğŸ‘‰ **í•˜ë£¨ 1íšŒ ê°±ì‹ í•´ì„œ JSON ìºì‹œ**ë¡œ ì“°ëŠ” ê²Œ ì •ì„ì´ì•¼. (ì†ë„/ë ˆì´íŠ¸ë¦¬ë°‹/ì•ˆì •ì„± ë‹¤ ì´ë“)

ë°”ë¡œ ì“¸ ìˆ˜ ìˆê²Œ â€œê·œì¹™ + ìµœì†Œ ì½”ë“œâ€ë§Œ ì¤„ê²Œ.

---

## âœ… ìš´ì˜ ê·œì¹™ (ê³ ì •)

* `exchangeInfo`ë¡œ Spot ì‹¬ë³¼ ì „ì²´ ê°€ì ¸ì˜¤ê¸°: **í•˜ë£¨ 1íšŒ**
* ì €ì¥ íŒŒì¼: `storage/universe_YYYY-MM-DD.json`
* ëŸ°íƒ€ì„ì—ì„œëŠ”:

  1. ì˜¤ëŠ˜ íŒŒì¼ ìˆìœ¼ë©´ ê·¸ê±° ì‚¬ìš©
  2. ì—†ìœ¼ë©´ APIë¡œ ê°±ì‹  í›„ ì €ì¥
* ì¥ì•  ëŒ€ë¹„:

  * API ì‹¤íŒ¨í•˜ë©´ **ê°€ì¥ ìµœê·¼ íŒŒì¼** fallback

---

## âœ… JSON êµ¬ì¡° (ë‹¨ìˆœí•˜ê²Œ)

```json
{
  "date": "2026-01-25",
  "source": "binance_exchange_info",
  "symbols": ["AAVEUSDT", "ADAUSDT", "..."],
  "count": 1234
}
```

---

## âœ… ìµœì†Œ êµ¬í˜„ ì½”ë“œ (ê·¸ëŒ€ë¡œ ë¶™ì—¬ë„£ê¸°)

```python
import json, os
from datetime import datetime
from glob import glob
from binance.client import Client

def load_or_refresh_universe(client: Client, base_dir="storage"):
    os.makedirs(base_dir, exist_ok=True)
    today = datetime.now().strftime("%Y-%m-%d")
    today_path = os.path.join(base_dir, f"universe_{today}.json")

    # 1) ì˜¤ëŠ˜ ìºì‹œ ìˆìœ¼ë©´ ì‚¬ìš©
    if os.path.exists(today_path):
        with open(today_path, "r", encoding="utf-8") as f:
            return json.load(f)["symbols"]

    # 2) ì—†ìœ¼ë©´ ê°±ì‹  ì‹œë„
    try:
        info = client.get_exchange_info()
        symbols = sorted([
            s["symbol"]
            for s in info["symbols"]
            if s["status"] == "TRADING"
            and s.get("isSpotTradingAllowed", False)
            and s.get("quoteAsset") == "USDT"   # ë„ˆ ì „ëµ ê¸°ì¤€ì´ë©´ USDT ë§ˆì¼“ ê³ ì • ì¶”ì²œ
        ])

        payload = {
            "date": today,
            "source": "binance_exchange_info",
            "symbols": symbols,
            "count": len(symbols),
        }
        with open(today_path, "w", encoding="utf-8") as f:
            json.dump(payload, f, ensure_ascii=False, indent=2)

        return symbols

    except Exception as e:
        # 3) ì‹¤íŒ¨ ì‹œ ê°€ì¥ ìµœì‹  íŒŒì¼ fallback
        files = sorted(glob(os.path.join(base_dir, "universe_*.json")))
        if not files:
            raise RuntimeError(f"universe refresh failed and no cache exists: {e}")

        latest = files[-1]
        with open(latest, "r", encoding="utf-8") as f:
            return json.load(f)["symbols"]
```

---

## âœ… ë³´ë„ˆìŠ¤: â€œUSDTë§Œâ€ ê³ ì •í•˜ëŠ” ì´ìœ 

* ìŠ¤ìº” ìœ ë‹ˆë²„ìŠ¤ê°€ ëª…í™•í•´ì§
* ê°€ê²©/ì²´ê²°/ìˆ˜ìµ ê³„ì‚°ì´ ë‹¨ìˆœí•´ì§
* BTC/ETH ë§ˆì¼“ ì„ì´ë©´ ê³„ì‚°/ë¦¬ìŠ¤í¬ ë³µì¡í•´ì§

---

ì´ì œ ë„ˆ ë´‡ ì‹¤í–‰ íë¦„ì€ ì´ë ‡ê²Œ ê¹”ë”í•´ì ¸:

1. `symbols = load_or_refresh_universe(client)`
2. `for sym in symbols: analyze(sym)`

ì›í•˜ë©´ ë‹¤ìŒì€ ë°”ë¡œ

* ì´ universeì— **listed_days(ìƒì¥ì¼ ì¶”ì •)** ë¶™ì´ëŠ” ë°©ë²•(ìµœì´ˆ ìº”ë“¤ open_timeìœ¼ë¡œ ê³„ì‚°)
* `symbol_meta.json` ê°™ì´ ì €ì¥í•´ì„œ í•˜ë“œí•„í„° ì†ë„ ì˜¬ë¦¬ëŠ” ë°©ë²•
  ì´ìª½ìœ¼ë¡œ ì´ì–´ê°€ë©´ ë¨.
