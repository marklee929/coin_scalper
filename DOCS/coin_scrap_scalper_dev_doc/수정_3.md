ㅇㅋ. 지금 말한 운영 방식이 “꾸준 현금흐름”이랑 딱 맞아.
정리하면 **유니버스(스캔용) vs 워치리스트(실시간 감시용)** 를 분리하고, **자본을 1/N로 쪼개서 동시 보유 개수만큼만** 굴리는 구조지.

바로 코드로 옮길 수 있게 **규칙/구조/config 템플릿**만 박아줄게.

---

## 1) 운영 규칙 고정

### A. 코인 목록은 2종류

* **UNIVERSE (스캔용 전체)**: 하루 1회 갱신 JSON
* **ACTIVE_TICKERS (실시간 감시용 제한 목록)**: 최대 `MAX_WATCH_SYMBOLS` 개만 유지

### B. 자본 배분은 1/N

* `N = MAX_OPEN_POSITIONS` (동시 보유 수)
* **한 포지션당 투입금** = `available_usdt * ALLOC_PCT / N`

  * `ALLOC_PCT`: 전체 USDT 중 실제 운용 비율 (ex 0.9)
  * 92달러면 예: N=3이면 한 포지션 약 27달러 정도

### C. 돈 늘어나면 조절은 config로만

* `MAX_OPEN_POSITIONS` 늘리거나
* `ALLOC_PCT`(운용비율) 늘리거나
* `MIN_ORDER_USDT`(최소 주문금액)만 조절

---

## 2) config (settings.yaml 예시)

```yaml
capital:
  quote_asset: "USDT"
  alloc_pct: 0.90          # 운용에 쓸 비율 (10%는 완충)
  max_open_positions: 3    # N
  min_order_usdt: 12       # 바이낸스 최소 주문/필터 고려
  reserve_usdt: 5          # 최소 남겨둘 현금 (수수료/유연성)

universe:
  refresh_daily: true
  quote_asset_only: "USDT"
  exclude_new_listed_days: 2

watch:
  max_watch_symbols: 20    # 스캔에서 뽑아놓고 ticker로 감시할 최대 개수
  ticker_poll_sec: 3       # 감시 주기(너무 빠르면 레이트리밋)
  scan_interval_min: 30    # 전체 스캔은 n분마다 한번만

filters:
  change_24h_min: -20
  change_24h_max: -5
  min_quote_volume_24h: 1000000
```

---

## 3) 자본 배분 함수 (1/N)

```python
def calc_order_usdt(available_usdt, alloc_pct, max_open_positions, reserve_usdt):
    tradable = max(0.0, available_usdt * alloc_pct - reserve_usdt)
    if max_open_positions <= 0:
        return 0.0
    return tradable / max_open_positions
```

---

## 4) 실시간 감시 목록(Active Tickers) 운영 방식

### 핵심

* 전체 심볼을 계속 ticker로 보면 레이트리밋/비용/복잡도 터짐
* 그래서 **watchlist 상위 몇 개만 ticker 감시**
* watchlist는 스캔 루프가 갱신

### 흐름

1. 스캔 루프(30분마다):

   * universe 전체 알파벳 분석
   * 필터 통과 + 구조 통과 → 후보 점수 부여
   * 상위 `MAX_WATCH_SYMBOLS` 만 watchlist 저장
2. ticker 루프(3초마다):

   * watchlist에 있는 심볼만 ticker 조회
   * support zone 접근 + 거래량 유지면 entry 판단

---

## 5) 포지션 제한 규칙 (중요)

* `open_positions >= N` 이면 **절대 신규 진입 금지**
* 포지션 종료되면(익절/구조붕괴) 그때만 다음 진입 허용

```python
def can_open_new_position(open_count, max_open_positions):
    return open_count < max_open_positions
```

---

## 6) “92달러” 현실 체크 포인트

바이낸스는 심볼마다

* 최소 주문 수량
* 최소 노미널(USDT)
* stepSize
  이 다 달라서, **min_order_usdt를 12~15로** 잡는 게 안전해.

그래서 추천 세팅은:

* `max_open_positions = 3`
* `alloc_pct = 0.9`
* `reserve_usdt = 5`
  → 포지션당 대략 25~27달러

---

## 7) 운영상 가장 중요한 안전장치 2개

1. **“스캔은 느리게 / ticker는 제한된 목록만”**
2. **“자본은 1/N로만 / N 꽉 차면 신규 진입 금지”**

---

원하면 내가 다음을 바로 코드로 뽑아줄게:

* `watchlist`를 점수 기반으로 **20개만 유지**하는 함수(교체 로직 포함)
* 심볼별 `exchangeInfo` 필터(최소 주문/stepSize) 반영해서 **주문수량 자동 라운딩**
* “포지션당 투입금 < MIN_ORDER_USDT면 진입 금지” 룰까지 엔진에 박기
